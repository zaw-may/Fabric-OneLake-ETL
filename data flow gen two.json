{"name":"one_drive_flow_01","ppdf:dataflowId":"878e7fae-d147-4998-a43d-8ab4ecd6fb0d","ppdf:owner":{"tenantId":"50d54fc3-bf75-4120-8363-f271d481ee1c","userId":"a2cec25c-a780-40f9-9d67-11e8525e13f6"},"ppdf:fastCopy":true,"version":"1.0","culture":"en-US","modifiedTime":"2024-11-22T06:44:51.5799852+00:00","ppdf:outputFileFormat":"Parquet","pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"DefaultDestination":{"queryId":"784525a0-f92a-474d-a967-f771c77c914b","queryName":"DefaultDestination"},"order_details_raw":{"queryId":"d47c1819-05ba-452b-971f-ed184e746dea","queryName":"order_details_raw","loadEnabled":true},"order_details_raw_DataDestination":{"queryId":"53a66d73-1edb-4a7a-a322-db66bfab0998","queryName":"order_details_raw_DataDestination"},"order_details_raw_WriteToDataDestination":{"queryId":"c09dd4db-4aa0-4122-9962-f738cb44ede3","queryName":"order_details_raw_WriteToDataDestination"},"order_details_raw_TransformForWriteToDataDestination":{"queryId":"1e4d9e97-1c6b-4069-a0fd-9ecbb649afe8","queryName":"order_details_raw_TransformForWriteToDataDestination"},"FastCopyStaging":{"queryId":"cca5a8fb-dc24-4942-af9b-1f8c64d7804d","queryName":"FastCopyStaging"}},"document":"section Section1;\r\nshared DefaultDestination = let\r\n  DefaultDestination = Lakehouse.Contents(null){[workspaceId = \"925b65de-2eff-436b-a438-cdd995e7fda8\"]}[Data]{[lakehouseId = \"e5c51dfd-9994-4b0b-b794-85c826217008\"]}[Data]\r\nin\r\n  DefaultDestination;\r\n[Staging = \"FastCopyStaging\"]\r\nshared order_details_raw = let\n  Source = Csv.Document(Web.Contents(\"https://my.sharepoint.com/personal/zak/Documents/pvg/data_updated/template_to_upload.csv\"), [Delimiter = \",\", Columns = 44, QuoteStyle = QuoteStyle.None]),\n  #\"Promoted headers\" = Table.PromoteHeaders(Source, [PromoteAllScalars = true]),\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Promoted headers\", {{\"date\", type date}, {\"month_name\", type text}, {\"calendar_week\", Int64.Type}, {\"cust_name\", type text}, {\"sap_code\", Int64.Type}, {\"trans_category\", type text}, {\"project_name\", type text}, {\"country\", type text}, {\"sales_owner\", type text}, {\"quotation_ref\", type text}, {\"cust_po_no\", type text}, {\"order_no\", type text}, {\"vendor_order_no\", type text}, {\"supplier\", type text}, {\"main_vendor\", type text}, {\"industry_sector\", type text}, {\"cooling\", type text}, {\"service_no\", type text}, {\"order_type\", type text}, {\"eur\", type number}, {\"eur_to_thb\", type number}, {\"thb\", type number}, {\"thb_to_thb\", Int64.Type}, {\"usd\", Int64.Type}, {\"usd_to_thb\", type number}, {\"idr\", Int64.Type}, {\"idr_to_thb\", type number}, {\"sales_value\", type number}, {\"sales_margin_cent\", Percentage.Type}, {\"sales_margin_calculated\", Int64.Type}, {\"first_readiness_in_week\", Int64.Type}, {\"actual_readiness_in_week\", Int64.Type}, {\"delay\", Int64.Type}, {\"incoterm\", type text}, {\"shipping_cost\", type number}, {\"budget_service_in_day\", Int64.Type}, {\"installation_status\", type text}, {\"installation_value\", Int64.Type}, {\"budget_engineering_in_day\", Int64.Type}, {\"payment_term\", type text}, {\"remark\", type text}, {\"creator\", type text}, {\"updated_at\", type date}, {\"hash_key\", type text}}),\n  #\"Replaced errors\" = Table.ReplaceErrorValues(#\"Changed column type\", {{\"shipping_cost\", 0}, {\"budget_service_in_day\", 0}}),\n  #\"Replaced errors 1\" = Table.ReplaceErrorValues(#\"Replaced errors\", {{\"sales_value\", 0}}),\n  #\"Replaced errors 2\" = Table.ReplaceErrorValues(#\"Replaced errors 1\", {{\"eur\", 0.0}, {\"eur_to_thb\", 0.0}, {\"thb\", 0.0}, {\"thb_to_thb\", 0.0}, {\"usd\", 0.0}, {\"usd_to_thb\", 0.0}, {\"idr\", 0.0}, {\"idr_to_thb\", 0.0}}),\n  #\"Replaced errors 3\" = Table.ReplaceErrorValues(#\"Replaced errors 2\", {{\"first_readiness_in_week\", 0}}),\n  #\"Replaced errors 4\" = Table.ReplaceErrorValues(#\"Replaced errors 3\", {{\"budget_engineering_in_day\", 0}}),\n  #\"Changed column type 1\" = Table.TransformColumnTypes(#\"Replaced errors 4\", {{\"date\", type date}, {\"calendar_week\", Int64.Type}, {\"sap_code\", Int64.Type}, {\"eur\", type number}, {\"thb_to_thb\", type number}, {\"usd\", type number}, {\"idr\", type number}, {\"sales_margin_cent\", type number}, {\"sales_margin_calculated\", type number}, {\"installation_value\", type number}, {\"updated_at\", type date}}),\n  #\"Replaced value\" = Table.ReplaceValue(#\"Changed column type 1\", \"''\", \"NA\", Replacer.ReplaceText, {\"month_name\", \"cust_name\", \"trans_category\", \"project_name\", \"country\", \"sales_owner\", \"quotation_ref\", \"cust_po_no\", \"order_no\", \"vendor_order_no\", \"supplier\", \"main_vendor\", \"industry_sector\", \"cooling\", \"service_no\", \"order_type\", \"incoterm\", \"installation_status\", \"payment_term\", \"remark\", \"creator\", \"hash_key\"}),\r\n  #\"Replaced errors 5\" = Table.ReplaceErrorValues(#\"Replaced value\", {{\"date\", #date(9999, 12, 31)}})\nin\n  #\"Replaced errors 5\";\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\nshared order_details_raw_DataDestination = let\r\n  Pattern = Lakehouse.Contents([CreateNavigationProperties = false]),\r\n  Navigation_1 = Pattern{[workspaceId = \"925b65de-2eff-436b-a438-cdd995e7fda8\"]}[Data],\r\n  Navigation_2 = Navigation_1{[lakehouseId = \"e5c51dfd-9994-4b0b-b794-85c826217008\"]}[Data],\r\n  TableNavigation = Navigation_2{[Id = \"order_details_raw\", ItemKind = \"Table\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[date = nullable Date.Type, month_name = nullable Text.Type, calendar_week = nullable Int64.Type, cust_name = nullable Text.Type, sap_code = nullable Int64.Type, trans_category = nullable Text.Type, project_name = nullable Text.Type, country = nullable Text.Type, sales_owner = nullable Text.Type, quotation_ref = nullable Text.Type, cust_po_no = nullable Text.Type, order_no = nullable Text.Type, vendor_order_no = nullable Text.Type, supplier = nullable Text.Type, main_vendor = nullable Text.Type, industry_sector = nullable Text.Type, cooling = nullable Text.Type, service_no = nullable Text.Type, order_type = nullable Text.Type, eur = nullable Number.Type, eur_to_thb = nullable Number.Type, thb = nullable Number.Type, thb_to_thb = nullable Number.Type, usd = nullable Number.Type, usd_to_thb = nullable Number.Type, idr = nullable Number.Type, idr_to_thb = nullable Number.Type, sales_value = nullable Number.Type, sales_margin_cent = nullable Number.Type, sales_margin_calculated = nullable Number.Type, first_readiness_in_week = nullable Int64.Type, actual_readiness_in_week = nullable Int64.Type, delay = nullable Int64.Type, incoterm = nullable Text.Type, shipping_cost = nullable Number.Type, budget_service_in_day = nullable Int64.Type, installation_status = nullable Text.Type, installation_value = nullable Number.Type, budget_engineering_in_day = nullable Int64.Type, payment_term = nullable Text.Type, remark = nullable Text.Type, creator = nullable Text.Type, updated_at = nullable Date.Type, hash_key = nullable Text.Type], {}), [DeleteWhenEmpty = true])\r\nin\r\n  Table;\r\n[Staging = \"FastCopyStaging\"]\r\nshared order_details_raw_WriteToDataDestination = let\r\n  order_details_raw_WriteToDataDestination = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = order_details_raw_DataDestination], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], order_details_raw_TransformForWriteToDataDestination), Action.DoNothing}))\r\nin\r\n  order_details_raw_WriteToDataDestination;\r\nshared order_details_raw_TransformForWriteToDataDestination = let\r\n    SourceTable = Table.SelectColumns(order_details_raw, {\"date\", \"month_name\", \"calendar_week\", \"cust_name\", \"sap_code\", \"trans_category\", \"project_name\", \"country\", \"sales_owner\", \"quotation_ref\", \"cust_po_no\", \"order_no\", \"vendor_order_no\", \"supplier\", \"main_vendor\", \"industry_sector\", \"cooling\", \"service_no\", \"order_type\", \"eur\", \"eur_to_thb\", \"thb\", \"thb_to_thb\", \"usd\", \"usd_to_thb\", \"idr\", \"idr_to_thb\", \"sales_value\", \"sales_margin_cent\", \"sales_margin_calculated\", \"first_readiness_in_week\", \"actual_readiness_in_week\", \"delay\", \"incoterm\", \"shipping_cost\", \"budget_service_in_day\", \"installation_status\", \"installation_value\", \"budget_engineering_in_day\", \"payment_term\", \"remark\", \"creator\", \"updated_at\", \"hash_key\"})\r\nin\r\n    SourceTable;\r\nshared FastCopyStaging = let\r\n  FastCopyStaging = Pipeline.FastCopyModelStorage(DefaultStaging, [Required = false])\r\nin\r\n  FastCopyStaging;\r\n","connectionOverrides":[{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"1f202b98-fd9e-4cb6-8d17-f67ee7b73170","audience":null},{"path":"https://my.sharepoint.com/personal/zak/Documents/pvg/data_updated/Order%20Details%20Raw.csv","kind":"Web","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"8ca7eeee-f0bb-4e56-8139-fcf881ec6c72","audience":null},{"path":"https://my.sharepoint.com/personal/zak/","kind":"Web","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Web\",\"path\":\"https://my.sharepoint.com/personal/zak/\"}","audience":null}]},"entities":[{"$type":"LocalEntity","name":"order_details_raw","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"order_details_raw.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"date","dataType":"date"},{"name":"month_name","dataType":"string"},{"name":"calendar_week","dataType":"int64"},{"name":"cust_name","dataType":"string"},{"name":"sap_code","dataType":"int64"},{"name":"trans_category","dataType":"string"},{"name":"project_name","dataType":"string"},{"name":"country","dataType":"string"},{"name":"sales_owner","dataType":"string"},{"name":"quotation_ref","dataType":"string"},{"name":"cust_po_no","dataType":"string"},{"name":"order_no","dataType":"string"},{"name":"vendor_order_no","dataType":"string"},{"name":"supplier","dataType":"string"},{"name":"main_vendor","dataType":"string"},{"name":"industry_sector","dataType":"string"},{"name":"cooling","dataType":"string"},{"name":"service_no","dataType":"string"},{"name":"order_type","dataType":"string"},{"name":"eur","dataType":"double"},{"name":"eur_to_thb","dataType":"double"},{"name":"thb","dataType":"double"},{"name":"thb_to_thb","dataType":"double"},{"name":"usd","dataType":"double"},{"name":"usd_to_thb","dataType":"double"},{"name":"idr","dataType":"double"},{"name":"idr_to_thb","dataType":"double"},{"name":"sales_value","dataType":"double"},{"name":"sales_margin_cent","dataType":"double"},{"name":"sales_margin_calculated","dataType":"double"},{"name":"first_readiness_in_week","dataType":"int64"},{"name":"actual_readiness_in_week","dataType":"int64"},{"name":"delay","dataType":"int64"},{"name":"incoterm","dataType":"string"},{"name":"shipping_cost","dataType":"double"},{"name":"budget_service_in_day","dataType":"int64"},{"name":"installation_status","dataType":"string"},{"name":"installation_value","dataType":"double"},{"name":"budget_engineering_in_day","dataType":"int64"},{"name":"payment_term","dataType":"string"},{"name":"remark","dataType":"string"},{"name":"creator","dataType":"string"},{"name":"updated_at","dataType":"date"},{"name":"hash_key","dataType":"string"}]}]}